### 文件结构
neuron_task/
├── data_exploration.ipynb      # 数据探索和可视化
├── data_preprocessing.py       # 数据预处理和特征工程
├── models/
│   ├── classification_model.py # 分类模型定义
│   └── regression_model.py     # 回归模型定义
├── train_classification.py     # 分类任务训练脚本
├── train_regression.py         # 回归任务训练脚本
├── evaluate.py                 # 模型评估脚本
└── utils.py                    # 工具函数

### Pipeline
#### 阶段1：数据探索与分析 ✅ COMPLETED
1. 数据加载与检查 ✅
   + 加载4个numpy文件并检查数据形状和类型
   + 分析数据分布、缺失值、异常值
   + 可视化神经元信号和目标变量的分布

2. 数据探索性分析 ✅
   + 分析神经元信号的时间序列特征
   + 探索不同神经元之间的相关性
   + 分析网格ID分布和位置坐标范围
   + **关键发现**: 神经元激活持续时间分析确定最优窗口大小为 [24, 40, 63]

#### 阶段2：数据预处理 ✅ COMPLETED
1. 数据清洗 ✅
   + 处理异常值和噪声 (5σ规则)
   + 数据标准化/归一化 (StandardScaler)

2. 序列数据生成 ✅
   + 实现滑动窗口方法生成训练样本
   + **最优窗口大小**: 40 (基于神经元激活持续时间中位数)
   + 按照7:1:2比例划分训练/验证/测试集
   + **时序分割**: 使用时序分割而非随机分割

3. 类别不平衡处理 ✅
   + 计算平衡的类别权重 (imbalance ratio: 6.64)
   + 为训练阶段准备权重字典

4. 数据输出 ✅
   + **分类任务**: 18,862训练样本，形状(40, 147)，25个类别
   + **回归任务**: 18,880训练样本，形状(40, 147)，2维输出
   + 保存为float32格式以优化内存使用

#### 阶段3：模型设计与实现
##### 分类任务模型：
1.  基础模型
   + LSTM/GRU循环神经网络
   + 1D CNN卷积神经网络
   + Transformer模型
2.  高级模型
   + CNN-LSTM混合模型
   + 注意力机制增强模型
   + 多头注意力Transformer

##### 回归任务模型：
1.  基础模型
   + LSTM回归网络
   + 1D CNN回归网络
   + 全连接网络
2.  高级模型
   + CNN-LSTM混合回归模型
   + 时空注意力模型

#### 阶段4：模型训练与优化
1.  训练流程
   + 实现训练循环
   + 添加早停和学习率调度
   + 模型检查点保存
2.  超参数调优
   + 网格搜索或贝叶斯优化
   + 交叉验证
   + 正则化技术（Dropout、L1/L2）
3.  模型集成
   + 多模型投票或平均
   + Stacking集成方法

#### 阶段5：模型评估
1.  评估指标
   + 分类任务：准确率、精确率、召回率、F1分数、混淆矩阵
   + 回归任务：MSE、MAE、R²分数
2.  模型分析
   + 错误分析
   + 特征重要性分析
   + 可视化预测结果

#### 阶段6：结果优化与部署
1. 模型优化
   + 模型压缩和量化
   + 推理速度优化
2.  结果输出
   + 生成基准结果文件
   + 模型性能报告